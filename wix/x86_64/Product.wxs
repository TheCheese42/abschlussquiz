<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs" xmlns:ui="http://wixtoolset.org/schemas/v4/wxs/ui">
  <Package Name="Abschlussquiz" Manufacturer="Dominik Reinartz" Version="1.2.2" UpgradeCode="1ea4279d-2a7a-4e2e-b2a9-9b41d92f2f5a">
    <MajorUpgrade DowngradeErrorMessage="A newer version is already installed." />
    <Feature Id="FilesFeature">
      <ComponentGroupRef Id="Main" />
    </Feature>
    <Feature Id="ShortcutFeature" Title="Shortcuts" Level="1">
      <ComponentGroupRef Id="ShortcutGroup" />
    </Feature>
    <Media Id="1" Cabinet="abschlussquiz.cab" EmbedCab="yes" />
    <UI>
      <ui:WixUI Id="WixUI_InstallDir" />
       <Publish Dialog="WelcomeDlg" Control="Next" Event="NewDialog" Value="InstallDirDlg" Order="2"></Publish>
            <Publish Dialog="InstallDirDlg" Control="Back" Event="NewDialog" Value="WelcomeDlg" Order="2"></Publish>
    </UI>
  </Package>

  <Fragment>
    <StandardDirectory Id="ProgramFiles64Folder">
      <Directory Id="INSTALLFOLDER" Name="!(bind.Property.ProductName)" />
    </StandardDirectory>
    <Property Id="WIXUI_INSTALLDIR" Value="INSTALLFOLDER" />
    <StandardDirectory Id="ProgramMenuFolder" />
    <StandardDirectory Id="DesktopFolder" />

    <ComponentGroup Id="Main" Directory="INSTALLFOLDER">
      <Component>
        <File Source="../../export/abschlussquiz-windows-x86_64-portable.exe" Name="abschlussquiz-x86_64.exe" />
      </Component>
    </ComponentGroup>

    <ComponentGroup Id="ShortcutGroup">
      <Component Id="ApplicationShortcutDesktop" Guid="db366a14-8b81-4806-bd4c-546f77c068b8" Directory="DesktopFolder">
        <Shortcut Id="ApplicationDesktopShortcut"
          Name="!(bind.Property.ProductName)"
          Target="[INSTALLFOLDER]abschlussquiz-x86_64.exe"
          WorkingDirectory="INSTALLFOLDER"/>
        <RemoveFolder Id="DesktopFolder" On="uninstall"/>
        <RegistryValue Root="HKCU"
          Key="Software\Abschlussquiz"
          Name="installed"
          Type="integer"
          Value="1"
          KeyPath="yes"/>
      </Component>

      <Component Id="ApplicationShortcutMenu" Guid="5ddd125b-316d-42cc-817c-c9d3d6ff2b72" Directory="ProgramMenuFolder">
        <Shortcut Id="ApplicationStartMenuShortcut"
          Name="!(bind.Property.ProductName)"
          Target="[INSTALLFOLDER]abschlussquiz-x86_64.exe"
          WorkingDirectory="INSTALLFOLDER"/>
        <RemoveFolder Id="CleanUpShortCut" Directory="ProgramMenuFolder" On="uninstall"/>
        <RegistryValue Root="HKCU"
          Key="Software\Abschlussquiz"
          Name="installed"
          Type="integer"
          Value="1"
          KeyPath="yes"/>
      </Component>
    </ComponentGroup>
  </Fragment>
</Wix>
